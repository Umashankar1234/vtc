{"ast":null,"code":"import _slicedToArray from\"C:/Users/user/Desktop/Uma/vtc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback,useRef,Fragment,useContext}from'react';import moment from'moment';import ErrorOutlineIcon from'@material-ui/icons/ErrorOutline';import{AuthContext}from\"../CommonMethods/Authentication\";import DialogTitle from'@material-ui/core/DialogTitle';import DialogContent from'@material-ui/core/DialogContent';import Dialog from'@material-ui/core/Dialog';import Button from'@material-ui/core/Button';import{APIURL,APIPath}from\"../CommonMethods/Fetch\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SessionTimeout=function SessionTimeout(props){var _useState=useState(['click','load','scroll']),_useState2=_slicedToArray(_useState,2),events=_useState2[0],setEvents=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),second=_useState4[0],setSecond=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setOpen=_useState6[1];var _React$useState=React.useState('lg'),_React$useState2=_slicedToArray(_React$useState,2),maxWidth=_React$useState2[0],setMaxWidth=_React$useState2[1];var context=useContext(AuthContext);var _useContext=useContext(AuthContext),dispatch=_useContext.dispatch;var timeStamp;var warningInactiveInterval=useRef();var startTimerInterval=useRef();// start inactive check\nvar timeChecker=function timeChecker(){startTimerInterval.current=setTimeout(function(){var storedTimeStamp=sessionStorage.getItem('lastTimeStamp');warningInactive(storedTimeStamp);},60000);};// warning timer\nvar warningInactive=function warningInactive(timeString){clearTimeout(startTimerInterval.current);warningInactiveInterval.current=setInterval(function(){var diff=moment.duration(moment().diff(moment(timeString)));if(diff.minutes()===15){clearInterval(warningInactiveInterval.current);sessionStorage.removeItem('lastTimeStamp');setOpen(true);dispatch({type:\"LOGOUT\"});}},3000);};var resetTimer=useCallback(function(){clearTimeout(startTimerInterval.current);clearInterval(warningInactiveInterval.current);if(context.state.isAuthenticated){timeStamp=moment();sessionStorage.setItem('lastTimeStamp',timeStamp);}else{clearInterval(warningInactiveInterval.current);sessionStorage.removeItem('lastTimeStamp');}timeChecker();//setOpen(false);\n},[context.state.isAuthenticated]);// handle close popup\nvar handleClose=function handleClose(){dispatch({type:\"LOGOUT\"});setOpen(false);window.location.href=APIPath()+\"login\";// props.history.push(APIPath() + \"login\");\nresetTimer();};var handleCancel=function handleCancel(){dispatch({type:\"LOGOUT\"});setOpen(false);window.location.href=APIPath()+\"login\";resetTimer();};useEffect(function(){events.forEach(function(event){window.addEventListener(event,resetTimer);clearInterval(warningInactiveInterval.current);});timeChecker();return function(){clearTimeout(startTimerInterval.current);//   resetTimer();\n};},[resetTimer,events,timeChecker]);if(!isOpen){return null;}// change fragment to modal and handleclose func to close\nreturn/*#__PURE__*/_jsxs(Dialog,{maxWidth:maxWidth,disableBackdropClick:true,disableEscapeKeyDown:true,\"aria-labelledby\":\"customized-dialog-title\",open:isOpen,children:[/*#__PURE__*/_jsx(DialogTitle,{align:\"center\",style:{backgroundColor:\"red\",color:\"white\"},id:\"customized-dialog-title\",children:\"Session Timeout\"}),/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsx(ErrorOutlineIcon,{style:{display:\"block\",margin:\"0 auto\",fontSize:\"80px\",color:\"#ff5722\"}}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"5px 40px 28px 40px\"},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:\"26px\",margin:\"10px\"},children:\"Your online session has expired.\"}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:\"26px\",margin:\"10px\"},children:\"Please login again to continue.\"}),/*#__PURE__*/_jsx(Button,{style:{width:\"47%\",margin:\"7px\"},variant:\"contained\",color:\"primary\",onClick:handleClose,children:\"Login\"}),/*#__PURE__*/_jsx(Button,{style:{width:\"47%\"},variant:\"contained\",color:\"secondary\",onClick:handleCancel,children:\"Cancel\"})]})]})]});};export default SessionTimeout;","map":{"version":3,"sources":["C:/Users/user/Desktop/Uma/vtc/src/CommonMethods/SessionTimeout.js"],"names":["React","useState","useEffect","useCallback","useRef","Fragment","useContext","moment","ErrorOutlineIcon","AuthContext","DialogTitle","DialogContent","Dialog","Button","APIURL","APIPath","SessionTimeout","props","events","setEvents","second","setSecond","isOpen","setOpen","maxWidth","setMaxWidth","context","dispatch","timeStamp","warningInactiveInterval","startTimerInterval","timeChecker","current","setTimeout","storedTimeStamp","sessionStorage","getItem","warningInactive","timeString","clearTimeout","setInterval","diff","duration","minutes","clearInterval","removeItem","type","resetTimer","state","isAuthenticated","setItem","handleClose","window","location","href","handleCancel","forEach","event","addEventListener","backgroundColor","color","display","margin","fontSize","padding","width"],"mappings":"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","sourcesContent":["\nimport React, {\n    useState,\n    useEffect,\n    useCallback,\n    useRef,\n    Fragment,\n    useContext,\n} from 'react';\nimport moment from 'moment';\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\nimport { AuthContext } from \"../CommonMethods/Authentication\";\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport Dialog from '@material-ui/core/Dialog';\nimport Button from '@material-ui/core/Button';\nimport { APIURL, APIPath } from \"../CommonMethods/Fetch\";\nconst SessionTimeout = (props) => {\n    const [events, setEvents] = useState(['click', 'load', 'scroll']);\n    const [second, setSecond] = useState(0);\n    const [isOpen, setOpen] = useState(false);\n    const [maxWidth, setMaxWidth] = React.useState('lg');\n    const context = useContext(AuthContext);\n    const { dispatch } = useContext(AuthContext);\n\n    let timeStamp;\n    let warningInactiveInterval = useRef();\n    let startTimerInterval = useRef();\n\n    // start inactive check\n    let timeChecker = () => {\n        startTimerInterval.current = setTimeout(() => {\n            let storedTimeStamp = sessionStorage.getItem('lastTimeStamp');\n            warningInactive(storedTimeStamp);\n        }, 60000);\n    };\n\n    // warning timer\n    let warningInactive = (timeString) => {\n\n        clearTimeout(startTimerInterval.current);\n        warningInactiveInterval.current = setInterval(() => {\n            const diff = moment.duration(moment().diff(moment(timeString)));\n            if (diff.minutes() === 15) {\n                clearInterval(warningInactiveInterval.current);\n                sessionStorage.removeItem('lastTimeStamp');\n                setOpen(true);\n                dispatch({\n                    type: \"LOGOUT\"\n                });\n            }\n        }, 3000);\n    };\n    let resetTimer = useCallback(() => {\n        clearTimeout(startTimerInterval.current);\n        clearInterval(warningInactiveInterval.current);\n        if (context.state.isAuthenticated) {\n            timeStamp = moment();\n            sessionStorage.setItem('lastTimeStamp', timeStamp);\n        } else {\n            clearInterval(warningInactiveInterval.current);\n            sessionStorage.removeItem('lastTimeStamp');\n        }\n        timeChecker();\n        //setOpen(false);\n    }, [context.state.isAuthenticated]);\n\n    // handle close popup\n    const handleClose = () => {\n        dispatch({\n            type: \"LOGOUT\"\n        });\n        setOpen(false);\n        window.location.href = APIPath() + \"login\";\n        // props.history.push(APIPath() + \"login\");\n        resetTimer();\n    };\n    const handleCancel = () => {\n        dispatch({\n            type: \"LOGOUT\"\n        });\n        setOpen(false);\n        window.location.href = APIPath() + \"login\";\n        resetTimer();\n    }\n    useEffect(() => {\n        events.forEach((event) => {\n            window.addEventListener(event, resetTimer);\n            clearInterval(warningInactiveInterval.current);\n        });\n        timeChecker();\n        return () => {\n            clearTimeout(startTimerInterval.current);\n            //   resetTimer();\n        };\n    }, [resetTimer, events, timeChecker]);\n\n\n    if (!isOpen) {\n        return null;\n    }\n\n    // change fragment to modal and handleclose func to close\n    return <Dialog maxWidth={maxWidth} disableBackdropClick={true} disableEscapeKeyDown={true} aria-labelledby=\"customized-dialog-title\" open={isOpen}>\n        <DialogTitle align=\"center\" style={{ backgroundColor: \"red\", color: \"white\" }} id=\"customized-dialog-title\">\n            Session Timeout\n        </DialogTitle>\n        <DialogContent dividers>\n            <ErrorOutlineIcon style={{ display: \"block\", margin: \"0 auto\", fontSize: \"80px\", color: \"#ff5722\" }} />\n            <div style={{ padding: \"5px 40px 28px 40px\" }}>\n                <h3 style={{ fontSize: \"26px\", margin: \"10px\" }}>\n                    Your online session has expired.\n                </h3>\n                <h3 style={{ fontSize: \"26px\", margin: \"10px\" }}>\n                    Please login again to continue.\n                </h3>\n                <Button style={{ width: \"47%\", margin: \"7px\" }} variant=\"contained\" color=\"primary\" onClick={handleClose}>\n                    Login\n                </Button>\n                <Button style={{ width: \"47%\" }} variant=\"contained\" color=\"secondary\" onClick={handleCancel}>\n                    Cancel\n                </Button>\n            </div>\n        </DialogContent>\n    </Dialog>;\n};\n\nexport default SessionTimeout;"]},"metadata":{},"sourceType":"module"}