{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Uma\\\\vtc\\\\src\\\\CommonMethods\\\\SessionTimeout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useRef, Fragment, useContext } from 'react';\nimport moment from 'moment';\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\nimport { AuthContext } from \"../CommonMethods/Authentication\";\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport Dialog from '@material-ui/core/Dialog';\nimport Button from '@material-ui/core/Button';\nimport { APIURL, APIPath } from \"../CommonMethods/Fetch\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst SessionTimeout = props => {\n  _s();\n\n  const [events, setEvents] = useState(['click', 'load', 'scroll']);\n  const [second, setSecond] = useState(0);\n  const [isOpen, setOpen] = useState(false);\n  const [maxWidth, setMaxWidth] = React.useState('lg');\n  const context = useContext(AuthContext);\n  const {\n    dispatch\n  } = useContext(AuthContext);\n  let timeStamp;\n  let warningInactiveInterval = useRef();\n  let startTimerInterval = useRef(); // start inactive check\n\n  let timeChecker = () => {\n    startTimerInterval.current = setTimeout(() => {\n      let storedTimeStamp = sessionStorage.getItem('lastTimeStamp');\n      warningInactive(storedTimeStamp);\n    }, 60000);\n  }; // warning timer\n\n\n  let warningInactive = timeString => {\n    clearTimeout(startTimerInterval.current);\n    warningInactiveInterval.current = setInterval(() => {\n      const diff = moment.duration(moment().diff(moment(timeString)));\n\n      if (diff.minutes() === 15) {\n        clearInterval(warningInactiveInterval.current);\n        sessionStorage.removeItem('lastTimeStamp');\n        setOpen(true);\n        dispatch({\n          type: \"LOGOUT\"\n        });\n      }\n    }, 3000);\n  };\n\n  let resetTimer = useCallback(() => {\n    clearTimeout(startTimerInterval.current);\n    clearInterval(warningInactiveInterval.current);\n\n    if (context.state.isAuthenticated) {\n      timeStamp = moment();\n      sessionStorage.setItem('lastTimeStamp', timeStamp);\n    } else {\n      clearInterval(warningInactiveInterval.current);\n      sessionStorage.removeItem('lastTimeStamp');\n    }\n\n    timeChecker(); //setOpen(false);\n  }, [context.state.isAuthenticated]); // handle close popup\n\n  const handleClose = () => {\n    dispatch({\n      type: \"LOGOUT\"\n    });\n    setOpen(false);\n    window.location.href = APIPath() + \"login\"; // props.history.push(APIPath() + \"login\");\n\n    resetTimer();\n  };\n\n  const handleCancel = () => {\n    dispatch({\n      type: \"LOGOUT\"\n    });\n    setOpen(false);\n    window.location.href = APIPath() + \"login\";\n    resetTimer();\n  };\n\n  useEffect(() => {\n    events.forEach(event => {\n      window.addEventListener(event, resetTimer);\n      clearInterval(warningInactiveInterval.current);\n    });\n    timeChecker();\n    return () => {\n      clearTimeout(startTimerInterval.current); //   resetTimer();\n    };\n  }, [resetTimer, events, timeChecker]);\n\n  if (!isOpen) {\n    return null;\n  } // change fragment to modal and handleclose func to close\n\n\n  return /*#__PURE__*/_jsxDEV(Dialog, {\n    maxWidth: maxWidth,\n    disableBackdropClick: true,\n    disableEscapeKeyDown: true,\n    \"aria-labelledby\": \"customized-dialog-title\",\n    open: isOpen,\n    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n      align: \"center\",\n      style: {\n        backgroundColor: \"red\",\n        color: \"white\"\n      },\n      id: \"customized-dialog-title\",\n      children: \"Session Timeout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n      dividers: true,\n      children: [/*#__PURE__*/_jsxDEV(ErrorOutlineIcon, {\n        style: {\n          display: \"block\",\n          margin: \"0 auto\",\n          fontSize: \"80px\",\n          color: \"#ff5722\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"5px 40px 28px 40px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            fontSize: \"26px\",\n            margin: \"10px\"\n          },\n          children: \"Your online session has expired.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            fontSize: \"26px\",\n            margin: \"10px\"\n          },\n          children: \"Please login again to continue.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            width: \"47%\",\n            margin: \"7px\"\n          },\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: handleClose,\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            width: \"47%\"\n          },\n          variant: \"contained\",\n          color: \"secondary\",\n          onClick: handleCancel,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 12\n  }, this);\n};\n\n_s(SessionTimeout, \"dI75ot3jGd9jN2zM2+L297Wikhk=\");\n\n_c = SessionTimeout;\nexport default SessionTimeout;\n\nvar _c;\n\n$RefreshReg$(_c, \"SessionTimeout\");","map":{"version":3,"sources":["C:/Users/user/Desktop/Uma/vtc/src/CommonMethods/SessionTimeout.js"],"names":["React","useState","useEffect","useCallback","useRef","Fragment","useContext","moment","ErrorOutlineIcon","AuthContext","DialogTitle","DialogContent","Dialog","Button","APIURL","APIPath","SessionTimeout","props","events","setEvents","second","setSecond","isOpen","setOpen","maxWidth","setMaxWidth","context","dispatch","timeStamp","warningInactiveInterval","startTimerInterval","timeChecker","current","setTimeout","storedTimeStamp","sessionStorage","getItem","warningInactive","timeString","clearTimeout","setInterval","diff","duration","minutes","clearInterval","removeItem","type","resetTimer","state","isAuthenticated","setItem","handleClose","window","location","href","handleCancel","forEach","event","addEventListener","backgroundColor","color","display","margin","fontSize","padding","width"],"mappings":"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","sourcesContent":["\nimport React, {\n    useState,\n    useEffect,\n    useCallback,\n    useRef,\n    Fragment,\n    useContext,\n} from 'react';\nimport moment from 'moment';\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\nimport { AuthContext } from \"../CommonMethods/Authentication\";\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport Dialog from '@material-ui/core/Dialog';\nimport Button from '@material-ui/core/Button';\nimport { APIURL, APIPath } from \"../CommonMethods/Fetch\";\nconst SessionTimeout = (props) => {\n    const [events, setEvents] = useState(['click', 'load', 'scroll']);\n    const [second, setSecond] = useState(0);\n    const [isOpen, setOpen] = useState(false);\n    const [maxWidth, setMaxWidth] = React.useState('lg');\n    const context = useContext(AuthContext);\n    const { dispatch } = useContext(AuthContext);\n\n    let timeStamp;\n    let warningInactiveInterval = useRef();\n    let startTimerInterval = useRef();\n\n    // start inactive check\n    let timeChecker = () => {\n        startTimerInterval.current = setTimeout(() => {\n            let storedTimeStamp = sessionStorage.getItem('lastTimeStamp');\n            warningInactive(storedTimeStamp);\n        }, 60000);\n    };\n\n    // warning timer\n    let warningInactive = (timeString) => {\n\n        clearTimeout(startTimerInterval.current);\n        warningInactiveInterval.current = setInterval(() => {\n            const diff = moment.duration(moment().diff(moment(timeString)));\n            if (diff.minutes() === 15) {\n                clearInterval(warningInactiveInterval.current);\n                sessionStorage.removeItem('lastTimeStamp');\n                setOpen(true);\n                dispatch({\n                    type: \"LOGOUT\"\n                });\n            }\n        }, 3000);\n    };\n    let resetTimer = useCallback(() => {\n        clearTimeout(startTimerInterval.current);\n        clearInterval(warningInactiveInterval.current);\n        if (context.state.isAuthenticated) {\n            timeStamp = moment();\n            sessionStorage.setItem('lastTimeStamp', timeStamp);\n        } else {\n            clearInterval(warningInactiveInterval.current);\n            sessionStorage.removeItem('lastTimeStamp');\n        }\n        timeChecker();\n        //setOpen(false);\n    }, [context.state.isAuthenticated]);\n\n    // handle close popup\n    const handleClose = () => {\n        dispatch({\n            type: \"LOGOUT\"\n        });\n        setOpen(false);\n        window.location.href = APIPath() + \"login\";\n        // props.history.push(APIPath() + \"login\");\n        resetTimer();\n    };\n    const handleCancel = () => {\n        dispatch({\n            type: \"LOGOUT\"\n        });\n        setOpen(false);\n        window.location.href = APIPath() + \"login\";\n        resetTimer();\n    }\n    useEffect(() => {\n        events.forEach((event) => {\n            window.addEventListener(event, resetTimer);\n            clearInterval(warningInactiveInterval.current);\n        });\n        timeChecker();\n        return () => {\n            clearTimeout(startTimerInterval.current);\n            //   resetTimer();\n        };\n    }, [resetTimer, events, timeChecker]);\n\n\n    if (!isOpen) {\n        return null;\n    }\n\n    // change fragment to modal and handleclose func to close\n    return <Dialog maxWidth={maxWidth} disableBackdropClick={true} disableEscapeKeyDown={true} aria-labelledby=\"customized-dialog-title\" open={isOpen}>\n        <DialogTitle align=\"center\" style={{ backgroundColor: \"red\", color: \"white\" }} id=\"customized-dialog-title\">\n            Session Timeout\n        </DialogTitle>\n        <DialogContent dividers>\n            <ErrorOutlineIcon style={{ display: \"block\", margin: \"0 auto\", fontSize: \"80px\", color: \"#ff5722\" }} />\n            <div style={{ padding: \"5px 40px 28px 40px\" }}>\n                <h3 style={{ fontSize: \"26px\", margin: \"10px\" }}>\n                    Your online session has expired.\n                </h3>\n                <h3 style={{ fontSize: \"26px\", margin: \"10px\" }}>\n                    Please login again to continue.\n                </h3>\n                <Button style={{ width: \"47%\", margin: \"7px\" }} variant=\"contained\" color=\"primary\" onClick={handleClose}>\n                    Login\n                </Button>\n                <Button style={{ width: \"47%\" }} variant=\"contained\" color=\"secondary\" onClick={handleCancel}>\n                    Cancel\n                </Button>\n            </div>\n        </DialogContent>\n    </Dialog>;\n};\n\nexport default SessionTimeout;"]},"metadata":{},"sourceType":"module"}